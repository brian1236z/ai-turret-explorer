<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="page-title">AI Farm Land Sentry</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script type="module" src="https://ajax.googleapis.com/ajax/libs/model-viewer/3.4.0/model-viewer.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8f7f4;
            color: #343a40;
            padding-top: 64px;
        }
        .nav-link {
            @apply px-3 py-2 rounded-md text-sm font-medium text-gray-700 hover:text-white hover:bg-blue-600 transition-colors;
        }
        .nav-link.active {
            @apply bg-blue-700 text-white;
        }
        /* Updated mobile nav link style */
        .mobile-nav-link {
             @apply block w-full text-center px-4 py-3 mb-2 rounded-md text-base font-semibold text-white bg-gradient-to-r from-blue-600 to-blue-700 shadow-md hover:shadow-lg hover:scale-105 transition-all transform;
        }
        .mobile-nav-link:last-child {
            @apply mb-0; /* Remove margin from the last button */
        }

        .lang-btn {
            @apply px-3 py-1 rounded-md text-sm font-medium transition-colors;
        }
        .lang-btn.active {
            @apply bg-blue-700 text-white;
        }
        .lang-btn:not(.active) {
            @apply text-gray-500 hover:bg-gray-200;
        }
        .content-section {
            @apply max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16;
        }

        /* NEW KEYFRAMES */
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }

        .build-button {
            @apply w-full text-left p-6 bg-white rounded-lg shadow-lg flex items-center space-x-4 transition-all duration-300 transform;
            /* Apply the animation */
            animation: float 6s ease-in-out infinite;
        }

        /* Stagger animations for a 'cloudy' effect */
        #tab-btn-electronics { animation-delay: -3s; }
        #tab-btn-calibration { animation-delay: -1.5s; }
        #tab-btn-ai { animation-delay: -4.5s; }


        .build-button.active {
            @apply ring-4 ring-blue-500 ring-opacity-75 scale-105 bg-blue-50;
            animation-play-state: paused; /* Stop floating when active */
            transform: scale(1.05); /* Keep scale */
        }
        .build-button:not(.active) {
            @apply hover:bg-gray-50;
        }

        /* Stop float on hover and scale up */
        .build-button:hover:not(.active) {
            animation-play-state: paused;
            transform: scale(1.05);
            @apply shadow-xl;
        }

        .build-icon {
            @apply text-5xl text-blue-600 w-12;
        }
        .tab-content {
            @apply bg-white p-6 rounded-b-lg rounded-tr-lg shadow-md mt-6;
        }

        /* REMOVED .overview-card styles */

        .overview-content {
             @apply bg-white p-6 rounded-lg shadow-xl max-w-3xl mx-auto mt-6;
        }

        /* NEW styles for System Architecture clouds */
        .overview-cloud-wrapper {
            background: linear-gradient(135deg, rgba(147, 197, 253, 0.7), rgba(96, 165, 250, 0.7)); /* Soft blue gradient */
            border-radius: 50% 30% 50% 30% / 30% 50% 30% 50%; /* Cloud shape */
            padding: 1rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease-in-out;
            animation: float 6s ease-in-out infinite; /* Keep the floating animation */
            cursor: pointer;
            display: flex; /* Ensure content is centered */
            justify-content: center;
            align-items: center;
            text-align: center;
            width: 280px; /* Set a fixed width */
            height: 280px; /* Set a fixed height */
        }
        .overview-cloud-wrapper:hover {
            transform: translateY(-15px) scale(1.08); /* Lift and scale more on hover */
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            animation-play-state: paused; /* Stop floating on hover */
        }
        /* Stagger animations for overview clouds */
        #cloud-perception { animation-delay: -1s; }
        #cloud-decision { animation-delay: -3s; }
        #cloud-actuation { animation-delay: -5s; }

        .overview-button {
            @apply flex flex-col items-center justify-center p-4 bg-white bg-opacity-80 rounded-full shadow-inner; /* Inner white circle */
            color: #1e40af; /* Darker blue text */
            transition: all 0.3s ease-in-out;
            width: 100%;
            height: 100%;
            aspect-ratio: 1/1;
        }
        .overview-button:hover {
            @apply bg-blue-50;
            color: #1c3580;
        }
        .overview-button.active .overview-text-title {
            color: #000; /* Darken text when active */
        }
        .overview-button.active .overview-text-description {
            color: #333; /* Darken text when active */
        }

        .overview-cloud-wrapper.active {
             animation-play-state: paused; /* Stop floating when active */
             transform: translateY(0px) scale(1.08);
        }

        .overview-icon-inner {
            @apply text-5xl;
            color: #2563eb; /* Blue icon color */
        }
        .overview-text-title {
            @apply text-xl font-semibold mt-2;
            color: #1e40af; /* Primary blue for title */
        }
        .overview-text-description {
            @apply text-sm text-gray-700 mt-1;
            color: #4a5568; /* Sub-text color */
        }
        /* END of new styles */


        .component-card {
            @apply bg-white rounded-lg shadow-md overflow-hidden transition-all duration-300;
        }
        .category-button {
            @apply px-4 py-2 text-sm font-medium rounded-full cursor-pointer transition-all;
        }
        .category-button.active {
            @apply bg-blue-700 text-white shadow-lg;
        }
        .category-button:not(.active) {
            @apply bg-white text-blue-700 hover:bg-blue-100 shadow;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 450px;
            margin-left: auto;
            margin-right: auto;
            height: 350px;
            max-height: 400px;
        }
        model-viewer {
            width: 100%;
            height: 600px;
            background-color: #f8f7f4;
            --poster-color: #f8f7f4;
        }

        /* Custom Cloud-like Button Styles */
        .cloud-button-wrapper {
            background: linear-gradient(135deg, rgba(147, 197, 253, 0.7), rgba(96, 165, 250, 0.7)); /* Soft blue gradient */
            border-radius: 50% 30% 50% 30% / 30% 50% 30% 50%; /* Cloud shape */
            padding: 1rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease-in-out;
            animation: float 6s ease-in-out infinite; /* Keep the floating animation */
            cursor: pointer;
            display: flex; /* Ensure content is centered */
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        .cloud-button-wrapper:hover {
            transform: translateY(-15px) scale(1.08); /* Lift and scale more on hover */
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            animation-play-state: paused; /* Stop floating on hover */
        }

        /* Adjust individual button delays to maintain cloudy movement */
        #cloud-mech { animation-delay: -2s; }
        #cloud-elec { animation-delay: -4.5s; }
        #cloud-ai { animation-delay: -1.0s; }
        #cloud-calib { animation-delay: -3.5s; }

        .cloud-button {
            @apply flex flex-col items-center justify-center p-4 bg-white bg-opacity-80 rounded-full shadow-inner; /* Inner white circle */
            color: #1e40af; /* Darker blue text */
            transition: all 0.3s ease-in-out;
            width: 100%; /* Make inner button take full width of cloud wrapper */
            height: 100%; /* Make inner button take full height of cloud wrapper */
            aspect-ratio: 1/1; /* Ensure circular shape for inner button */
        }
        .cloud-button:hover {
            @apply bg-blue-50;
            color: #1c3580;
        }
        .cloud-button.active .cloud-text-title {
            color: #000; /* Darken text when active */
        }
        .cloud-button.active .cloud-text-description {
            color: #333; /* Darken text when active */
        }

        .cloud-text-title {
            @apply text-xl font-semibold mt-2;
            color: #1e40af; /* Primary blue for title */
        }
        .cloud-text-description {
            @apply text-sm text-gray-700 mt-1;
            color: #4a5568; /* Sub-text color */
        }
        .cloud-icon {
            @apply text-5xl;
            color: #2563eb; /* Blue icon color */
        }
    </style>
</head>
<body class="antialiased">

    <nav class="bg-white shadow-sm fixed top-0 left-0 right-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex-shrink-0 flex items-center">
                    <span class="text-2xl font-bold text-blue-700" data-lang-key="nav_title">AI Farm Land Sentry</span>
                </div>

                <!-- Desktop Nav -->
                <div class="hidden sm:flex sm:items-center sm:space-x-4">
                    <div class="flex space-x-4">
                        <a href="#home" class="nav-link" data-lang-key="nav_home">Home</a>
                        <a href="#turret-3d" class="nav-link" data-lang-key="nav_3d">3D Turret View</a>
                        <a href="#overview" class="nav-link" data-lang-key="nav_overview">System Overview</a>
                        <a href="#live-feed" class="nav-link" data-lang-key="nav_live_feed">Live Feed</a>
                        <a href="#components" class="nav-link" data-lang-key="nav_components">Components</a>
                        <a href="#build" class="nav-link" data-lang-key="nav_build">Build Guides</a>
                        <a href="#safety" class="nav-link" data-lang-key="nav_safety">Safety</a>
                    </div>

                    <!-- Language Switcher (Desktop) - REMOVED -->
                    
                </div>

                <!-- Mobile Menu Button -->
                <div class="sm:hidden flex items-center">
                    <button id="mobile-menu-btn" class="inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-white hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white">
                        <span class="sr-only">Open main menu</span>
                        <!-- Hamburger Icon -->
                        <svg class="block h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                        </svg>
                        <!-- Close Icon (hidden by default) -->
                        <svg class="hidden h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </button>
                </div>
            </div>
        </div>

        <!-- Mobile Menu (hidden by default) -->
        <div id="mobile-menu" class="hidden sm:hidden bg-white shadow-lg">
            <div class="px-4 pt-4 pb-3 space-y-1">
                <a href="#home" class="mobile-nav-link" data-lang-key="nav_home">Home</a>
                <a href="#turret-3d" class="mobile-nav-link" data-lang-key="nav_3d">3D Turret View</a>
                <a href="#overview" class="mobile-nav-link" data-lang-key="nav_overview">System Overview</a>
                <a href="#live-feed" class="mobile-nav-link" data-lang-key="nav_live_feed">Live Feed</a>
                <a href="#components" class="mobile-nav-link" data-lang-key="nav_components">Components</a>
                <a href="#build" class="mobile-nav-link" data-lang-key="nav_build">Build Guides</a>
                <a href="#safety" class="mobile-nav-link" data-lang-key="nav_safety">Safety</a>
            </div>
            <!-- Language Switcher (Mobile) - REMOVED -->
        </div>
    </nav>

    <main>
        <section id="home" class="content-section bg-white shadow-inner">
            <div class="text-center">
                <h1 class="text-4xl font-bold tracking-tight text-gray-900 sm:text-5xl" data-lang-key="home_title">AI-Powered Autonomous Turret</h1>
                <p class="mt-6 text-xl leading-8 text-gray-700 max-w-3xl mx-auto" data-lang-key="home_subtitle">An interactive guide to the construction and programming of an intelligent, non-lethal wildlife deterrent. This system is designed to identify and discourage specific animals from protected areas while actively detecting and avoiding human presence.</p>
                <div class="mt-10 flex items-center justify-center gap-x-6">
                    <a href="#overview" class="rounded-md bg-gradient-to-r from-blue-600 to-blue-700 px-5 py-3 text-lg font-semibold text-white shadow-md hover:shadow-lg hover:scale-105 transition-all transform" data-lang-key="home_explore_btn">Explore the System</a>
                </div>
            </div>
            <div class="mt-16 max-w-6xl mx-auto grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8 text-center">
                <div class="bg-gray-50 p-6 rounded-lg shadow-md">
                    <span class="text-6xl" role="img" aria-label="macaque">üêµ</span>
                    <h3 class="mt-4 text-lg font-semibold" data-lang-key="home_target1_title">Target: Macaque</h3>
                    <p class="text-gray-600" data-lang-key="home_target1_desc">Formosan Macaque (*Macaca cyclopis*)</p>
                </div>
                <div class="bg-gray-50 p-6 rounded-lg shadow-md">
                    <span class="text-6xl" role="img" aria-label="deer">ü¶å</span>
                    <h3 class="mt-4 text-lg font-semibold" data-lang-key="home_target2_title">Target: Muntjac</h3>
                    <p class="text-gray-600" data-lang-key="home_target2_desc">Formosan Muntjac (*Muntiacus reevesi micrurus*)</p>
                </div>
                <div class="bg-gray-50 p-6 rounded-lg shadow-md">
                    <span class="text-6xl" role="img" aria-label="bear">üêª</span>
                    <h3 class="mt-4 text-lg font-semibold" data-lang-key="home_target3_title">Target: Black Bear</h3>
                    <p class="text-gray-600" data-lang-key="home_target3_desc">Formosan Black Bear (*Ursus thibetanus formosanus*)</p>
                </div>
                <div class="bg-gray-50 p-6 rounded-lg shadow-md">
                    <span class="text-6xl" role="img" aria-label="wild boar">üêó</span>
                    <h3 class="mt-4 text-lg font-semibold" data-lang-key="home_target4_title">Target: Wild Boar</h3>
                    <p class="text-gray-600" data-lang-key="home_target4_desc">Formosan Wild Boar (*Sus scrofa taivanus*)</p>
                </div>
                <div class="bg-red-50 p-6 rounded-lg shadow-md border-2 border-red-300 sm:col-span-2 lg:col-span-4">
                    <span class="text-6xl" role="img" aria-label="person">üë§</span>
                    <h3 class="mt-4 text-lg font-semibold text-red-800" data-lang-key="home_avoid_title">Avoid: Human</h3>
                    <p class="text-red-700" data-lang-key="home_avoid_desc">System enters safe mode on human detection.</p>
                </div>
            </div>
        </section>

        

<section id="turret-3d" class="content-section bg-gray-100 shadow-inner">
            <h2 class="text-3xl font-bold text-center mb-4" data-lang-key="3d_title">Interactive 3D AI Farm Land Sentry View</h2>
            <p class="text-lg text-gray-700 text-center max-w-3xl mx-auto mb-12" data-lang-key="3d_subtitle">Explore the AI Farm Land Sentry from every angle! Use your mouse/finger to rotate, pan, and zoom the model. This interactive view allows you to inspect the mechanical and electronic components in detail.</p>
            <div class="max-w-4xl mx-auto bg-white rounded-lg shadow-xl overflow-hidden">
                
                <!-- 
                  Note: The 'src' path below assumes the .glb file is in the same directory or a relative path.
                  For GitHub Pages, it's an absolute path to the repo.
                -->
<model-viewer
                    src="https://brianhexer.github.io/AI-Farm-Land-Sentry/ai-turret-explorer.glb"
                    poster="https://brianhexer.github.io/AI-Farm-Land-Sentry/ai-turret-explorer.webp"
                    alt="Interactive 3D model of the AI Farm Land Sentry"
                    ar
                    ar-modes="webxr scene-viewer quick-look"
                    camera-controls
                    touch-action="pan-y"
                    auto-rotate
                    shadow-intensity="1"
                    environment-image="neutral">
                    <div class="progress-bar hide" slot="progress-bar">
                        <div class="update-bar"></div>
                    </div>
                </model-viewer>
                <div class="p-6 text-center text-gray-600 text-sm">
                    <p data-lang-key="3d_note1">
                        <strong>Note:</strong> This is an interactive 3D model viewer. It is currently displaying the "AI Farm Land Sentry" model.
                    </p>
                </div>
            </div>
        </section>


<section id="overview" class="content-section">
            <h2 class="text-3xl font-bold text-center mb-4" data-lang-key="overview_title">System Architecture</h2>
            <p class="text-lg text-gray-700 text-center max-w-3xl mx-auto mb-12" data-lang-key="overview_subtitle">The turret operates on a classic "Perception-Decision-Actuation" loop. This model explains how the components work together in real-time. Click a cloud to learn more about its function and key components.</p>

            <div class="flex flex-col md:flex-row items-center justify-center gap-8 mb-8">

                <!-- Perception Cloud -->
                <div id="cloud-perception" class="overview-cloud-wrapper" data-overview="perception">
                    <button class="overview-button" id="btn-perception">
                        <span class="overview-icon-inner" role="img" aria-label="eye">üëÅÔ∏è</span>
                        <h3 class="overview-text-title" data-lang-key="overview_btn1_title">1. Perception</h3>
                        <p class="overview-text-description" data-lang-key="overview_btn1_desc">Sensing the environment.</p>
                    </button>
                </div>

                <!-- Decision Cloud -->
                <div id="cloud-decision" class="overview-cloud-wrapper" data-overview="decision">
                     <button class="overview-button" id="btn-decision">
                        <span class="overview-icon-inner" role="img" aria-label="brain">üß†</span>
                        <h3 class="overview-text-title" data-lang-key="overview_btn2_title">2. Decision</h3>
                        <p class="overview-text-description" data-lang-key="overview_btn2_desc">Analyzing and planning.</p>
                    </button>
                </div>

                <!-- Actuation Cloud -->
                <div id="cloud-actuation" class="overview-cloud-wrapper" data-overview="actuation">
                     <button class="overview-button" id="btn-actuation">
                        <span class="overview-icon-inner" role="img" aria-label="gear">‚öôÔ∏è</span>
                        <h3 class="overview-text-title" data-lang-key="overview_btn3_title">3. Actuation</h3>
                        <p class="overview-text-description" data-lang-key="overview_btn3_desc">Taking physical action.</p>
                    </button>
                </div>
            </div>

            <!-- Content for Perception -->
            <div id="content-perception" class="overview-content hidden">
                <h3 class="text-2xl font-semibold text-blue-700 mb-3" data-lang-key="overview_content1_title">Perception: The 360¬∞ Tri-Camera System</h3>
                <p class="text-gray-700" data-lang-key="overview_content1_desc">The system perceives its environment using a tri-camera array (3x Logitech C615 webcams), providing a stitched 360-degree panoramic view. The real-time feeds are processed by the AI, with each camera covering a 120-degree sector.</p>

            </div>

            <!-- Content for Decision -->
            <div id="content-decision" class="overview-content hidden">
                <h3 class="text-2xl font-semibold text-blue-700 mb-3" data-lang-key="overview_content2_title">Decision: The AI Brain (Jetson & YOLO)</h3>
                <p class="text-gray-700" data-lang-key="overview_content2_desc">The heart of the decision-making process is the NVIDIA Jetson Orin Nano. It runs a custom-trained YOLO model, processing all camera feeds in real-time. This model detects and classifies objects (macaque, muntjac, human). The control software applies a simple logic: if a human is seen, enter "Safe Mode." If a target animal is seen (and no human), calculate its position and initiate tracking.</p>
            </div>

            <!-- Content for Actuation -->
            <div id="content-actuation" class="overview-content hidden">
                <h3 class="text-2xl font-semibold text-blue-700 mb-3" data-lang-key="overview_content3_title">Actuation: The Mechanical Response</h3>
                <p class="text-gray-700" data-lang-key="overview_content3_desc">Based on the AI's decision, the Jetson commands the physical hardware. It sends signals to two NEMA 23 stepper motors via DM542S drivers, which move the high-torque herringbone gear pan-tilt mechanism to aim the paintball gun. To fire, it sends a signal to a relay, which activates a 24V solenoid to pull the trigger. This entire loop repeats multiple times per second.</p>
            </div>
        </section>

        <!-- NEW LIVE FEED SECTION -->
        <section id="live-feed" class="content-section bg-gray-900 shadow-inner">
            <h2 class="text-3xl font-bold text-center text-white mb-4" data-lang-key="live_feed_title">Live 360¬∞ Visual Feed</h2>
            <p class="text-lg text-gray-300 text-center max-w-3xl mx-auto mb-12" data-lang-key="live_feed_subtitle">This interface shows the real-time stitched video from the 3-camera array. The 360¬∞ scale below maps each camera's 120¬∞ sector, and each feed includes GPS data.</p>
            
            <!-- "Attached" Camera Feeds -->
            <div class="max-w-7xl mx-auto flex flex-col md:flex-row rounded-t-lg overflow-hidden shadow-lg border-2 border-b-0 border-gray-700">
                
                <!-- Camera 1 -->
                <div class="flex-1 bg-gray-800">
                    <div class="relative">
                        <!-- Overlay -->
                        <div class="absolute top-0 left-0 right-0 p-3 bg-black bg-opacity-60 text-white text-sm font-mono z-10">
                            <div class="flex justify-between items-center">
                                <span class="font-bold text-green-400">CAM 1 (0¬∞ - 120¬∞)</span>
                                <span>23.9732¬∞N 121.6061¬∞E</span>
                            </div>
                        </div>
                        <!-- Mock Feed -->
                        <div class="aspect-video w-full bg-black flex items-center justify-center text-gray-700">
                            <svg class="w-20 h-20" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M4 8h11a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1V9a1 1 0 011-1z"></path></svg>
                        </div>
                    </div>
                </div>
        
                <!-- Camera 2 -->
                <div class="flex-1 bg-gray-800 border-l border-r border-gray-700">
                    <div class="relative">
                        <!-- Overlay -->
                        <div class="absolute top-0 left-0 right-0 p-3 bg-black bg-opacity-60 text-white text-sm font-mono z-10">
                            <div class="flex justify-between items-center">
                                <span class="font-bold text-red-400">CAM 2 (120¬∞ - 240¬∞)</span>
                                <span>23.9732¬∞N 121.6061¬∞E</span>
                            </div>
                        </div>
                        <!-- Mock Feed -->
                        <div class="aspect-video w-full bg-black flex items-center justify-center text-gray-700">
                            <svg class="w-20 h-20" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M4 8h11a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1V9a1 1 0 011-1z"></path></svg>
                        </div>
                    </div>
                </div>
        
                <!-- Camera 3 -->
                <div class="flex-1 bg-gray-800">
                    <div class="relative">
                        <!-- Overlay -->
                        <div class="absolute top-0 left-0 right-0 p-3 bg-black bg-opacity-60 text-white text-sm font-mono z-10">
                            <div class="flex justify-between items-center">
                                <span class="font-bold text-blue-400">CAM 3 (240¬∞ - 360¬∞)</span>
                                <span>23.9732¬∞N 121.6061¬∞E</span>
                            </div>
                        </div>
                        <!-- Mock Feed -->
                        <div class="aspect-video w-full bg-black flex items-center justify-center text-gray-700">
                            <svg class="w-20 h-20" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M4 8h11a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1V9a1 1 0 011-1z"></path></svg>
                        </div>
                    </div>
                </div>
            </div>

            <!-- New 360 Degree Scale Bar -->
            <div class="max-w-7xl mx-auto bg-gray-800 rounded-b-lg shadow-lg border-2 border-t-0 border-gray-700 p-4">
                <!-- Bar -->
                <div class="w-full bg-gray-900 rounded-full h-8 flex overflow-hidden font-mono">
                    <!-- CAM 1: 0¬∞ - 120¬∞ -->
                    <div class="flex items-center justify-center text-sm font-bold text-white" style="flex-basis: 33.333%; background-image: linear-gradient(90deg, #10B981, #34D399);">
                        <span>CAM 1</span>
                    </div>
                    <!-- CAM 2: 120¬∞ - 240¬∞ -->
                    <div class="flex items-center justify-center text-sm font-bold text-white" style="flex-basis: 33.333%; background-image: linear-gradient(90deg, #F87171, #FCA5A5);">
                        <span>CAM 2</span>
                    </div>
                    <!-- CAM 3: 240¬∞ - 360¬∞ -->
                    <div class="flex items-center justify-center text-sm font-bold text-white" style="flex-basis: 33.333%; background-image: linear-gradient(90deg, #60A5FA, #93C5FD);">
                        <span>CAM 3</span>
                    </div>
                </div>
                <!-- Compass Labels -->
                <div class="flex justify-between text-xs text-gray-400 mt-2 px-1 font-mono">
                    <span class="font-bold text-white">0¬∞ N</span>
                    <span>30¬∞</span>
                    <span>60¬∞</span>
                    <span class="font-bold text-white">90¬∞ E</span>
                    <span>120¬∞</span>
                    <span>150¬∞</span>
                    <span class="font-bold text-white">180¬∞ S</span>
                    <span>210¬∞</span>
                    <span>240¬∞</span>
                    <span class="font-bold text-white">270¬∞ W</span>
                    <span>300¬∞</span>
                    <span>330¬∞</span>
                    <span class="font-bold text-white">360¬∞ N</span>
                </div>
            </div>
        </section>


        <section id="components" class="content-section">
            <h2 class="text-3xl font-bold text-center mb-4" data-lang-key="components_title">Interactive Bill of Materials</h2>
            <p class="text-lg text-gray-700 text-center max-w-3xl mx-auto mb-12" data-lang-key="components_subtitle">This is the complete list of components required for the project. Use the filters to explore parts by category or use the search bar to find a specific item. A breakdown of component categories is shown in the chart.</p>

            <div class="flex flex-col md:flex-row gap-8">
                <!-- Left Column: Chart and Software -->
                <div class="w-full md:w-1/3">
                    <h3 class="text-2xl font-semibold text-center mb-4" data-lang-key="components_chart_title">Component Categories</h3>
                    <div class="chart-container">
                        <canvas id="bomChart"></canvas>
                    </div>

                    <h3 class="text-2xl font-semibold text-center mb-4 mt-12" data-lang-key="components_software_title">Key Software Stack</h3>
                    <div class="space-y-3">
                        <div class="p-4 bg-white rounded-lg shadow-md">
                            <h4 class="font-semibold text-blue-800" data-lang-key="components_sw1_title">Operating System</h4>
                            <p class="text-sm text-gray-700" data-lang-key="components_sw1_desc">NVIDIA JetPack SDK (on Jetson)</p>
                            <p class="text-xs text-gray-500" data-lang-key="components_sw1_notes">Includes Ubuntu, CUDA, cuDNN, and TensorRT.</p>
                        </div>
                        <div class="p-4 bg-white rounded-lg shadow-md">
                            <h4 class="font-semibold text-blue-800" data-lang-key="components_sw2_title">Core Language</h4>
                            <p class="text-sm text-gray-700" data-lang-key="components_sw2_desc">Python 3.x</p>
                            <p class="text-xs text-gray-500" data-lang-key="components_sw2_notes">For the main control script, inference, and hardware I/O.</p>
                        </div>
                        <div class="p-4 bg-white rounded-lg shadow-md">
                            <h4 class="font-semibold text-blue-800" data-lang-key="components_sw3_title">AI / Object Detection</h4>
                            <p class="text-sm text-gray-700" data-lang-key="components_sw3_desc">Ultralytics YOLO (v11 cited, v8+ common)</p>
                            <p class="text-xs text-gray-500" data-lang-key="components_sw3_notes">Used for training and running the detection model.</p>
                        </div>
                        <div class="p-4 bg-white rounded-lg shadow-md">
                            <h4 class="font-semibold text-blue-800" data-lang-key="components_sw4_title">Key Libraries</h4>
                            <p class="text-sm text-gray-700" data-lang-key="components_sw4_desc">OpenCV, TensorRT, RPi.GPIO (or similar)</p>
                            <p class="text-xs text-gray-500" data-lang-key="components_sw4_notes">For camera vision, model acceleration, and motor control.</p>
                        </div>
                    </div>
                </div>

                <!-- Right Column: Search and Component List -->
                <div class="w-full md:w-2/3">
                    <div class="mb-4">
                        <input type="text" id="searchInput" class="w-full px-4 py-3 rounded-lg shadow-inner border border-gray-300" placeholder="Search for a component (e.g., 'Jetson', 'NEMA 23')..." data-lang-key="components_search_placeholder">
                    </div>
                    <div id="category-filters" class="flex flex-wrap gap-2 mb-6">
                        <!-- Category buttons will be injected here by JS -->
                    </div>

                    <div id="component-grid" class="grid grid-cols-1 md:grid-cols-2 gap-4 max-h-[600px] overflow-y-auto pr-2">
                        <!-- Component cards will be injected here by JS -->
                    </div>
                </div>
            </div>
        </section>

        <section id="build" class="content-section bg-gray-100 shadow-inner">
            <h2 class="text-3xl font-bold text-center mb-12" data-lang-key="build_title">Interactive Build Guides</h2>
            <p class="text-lg text-gray-700 text-center max-w-3xl mx-auto mb-12" data-lang-key="build_subtitle">Explore the four core phases of building this AI Turret. Click on any cloud below to reveal detailed steps, challenges, and insights for that stage of development.</p>

            <!-- Cloud Button Grid -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 justify-items-center">

                <!-- Mechanical Assembly Cloud Button -->
                <div id="cloud-mech" class="cloud-button-wrapper" data-tab="mechanical">
                    <button class="cloud-button" id="tab-btn-mechanical">
                        <span class="cloud-icon" role="img" aria-label="gears">üî©</span>
                        <h3 class="cloud-text-title" data-lang-key="build_btn1_title">Mechanical Assembly</h3>
                        <p class="cloud-text-description" data-lang-key="build_btn1_desc">Physical frame & motion system</p>
                    </button>
                </div>

                <!-- Electronics & Wiring Cloud Button -->
                <div id="cloud-elec" class="cloud-button-wrapper" data-tab="electronics">
                    <button class="cloud-button" id="tab-btn-electronics">
                        <span class="cloud-icon" role="img" aria-label="circuit">‚ö°</span>
                        <h3 class="cloud-text-title" data-lang-key="build_btn2_title">Electronics & Wiring</h3>
                        <p class="cloud-text-description" data-lang-key="build_btn2_desc">Power, logic & control components</p>
                    </button>
                </div>

                <!-- AI Model & Software Cloud Button -->
                <div id="cloud-ai" class="cloud-button-wrapper" data-tab="ai">
                    <button class="cloud-button" id="tab-btn-ai">
                        <span class="cloud-icon" role="img" aria-label="brain">üß†</span>
                        <h3 class="cloud-text-title" data-lang-key="build_btn3_title">AI Model & Software</h3>
                        <p class="cloud-text-description" data-lang-key="build_btn3_desc">Training vision & control script</p>
                    </button>
                </div>

                <!-- Calibration & Testing Cloud Button -->
                <div id="cloud-calib" class="cloud-button-wrapper" data-tab="calibration">
                    <button class="cloud-button" id="tab-btn-calibration">
                        <span class="cloud-icon" role="img" aria-label="target">üéØ</span>
                        <h3 class="cloud-text-title" data-lang-key="build_btn4_title">Calibration & Testing</h3>
                        <p class="cloud-text-description" data-lang-key="build_btn4_desc">Aligning vision & hardware</p>
                    </button>
                </div>
            </div>

            <!-- Collapsible content sections -->
            <div id="tab-content-mechanical" class="tab-content hidden">
                <h3 class="text-2xl font-semibold text-blue-700 mb-4" data-lang-key="build_content1_title">Phase 1: Mechanical Assembly</h3>
                <p class="mb-6 text-gray-700" data-lang-key="build_content1_desc">This phase involves building the physical structure and motion system. Precision and rigidity are the primary goals. The core of this phase is the high-torque herringbone gear drive, which provides backlash-free, precise aiming.</p>
                <ul class="space-y-4">
                    <li class="p-4 bg-gray-50 rounded-lg shadow-sm">
                        <h4 class="font-semibold text-lg" data-lang-key="build_content1_step1_title">1. Construct the Main Frame</h4>
                        <p class="text-gray-600" data-lang-key="build_content1_step1_desc">Assemble the 2020 aluminum extrusion base and gantry. Use corner brackets and T-nuts to create a rigid skeleton, ensuring all corners are perfectly square.</p>
                    </li>
                    <li class="p-4 bg-gray-50 rounded-lg shadow-sm">
                        <h4 class="font-semibold text-lg" data-lang-key="build_content1_step2_title">2. Fabricate & Assemble Pan-Tilt Drive</h4>
                        <p class="text-gray-600" data-lang-key="build_content1_step2_desc">3D print the large herringbone gears (pan and tilt) and motor pinions from PETG or ABS. Mount the pan motor inside the frame, meshing with the main ring gear which sits on a thrust bearing. Assemble the tilt gantry with its motor and gear, supported by deep groove ball bearings.</p>
                    </li>
                    <li class="p-4 bg-gray-50 rounded-lg shadow-sm">
                        <h4 class="font-semibold text-lg" data-lang-key="build_content1_step3_title">3. Mount Payload & Vision System</h4>
                        <p class="text-gray-600" data-lang-key="build_content1_step3_desc">Secure the paintball gun in its 3D printed cradle. Install the 24V solenoid using a custom bracket, aligning it perfectly with the trigger. Mount the three webcams on the stationary base frame to create the overlapping 360¬∞ field of view.</p>
                    </li>
                </ul>
            </div>

            <div id="tab-content-electronics" class="tab-content hidden">
                <h3 class="text-2xl font-semibold text-blue-700 mb-4" data-lang-key="build_content2_title">Phase 2: Electronics & Wiring</h3>
                <p class="mb-6 text-gray-700" data-lang-key="build_content2_desc">This phase connects all components, distributing power and control signals. A clean, methodical wiring plan with proper grounding is essential to prevent electrical noise from interfering with the Jetson's logic signals.</p>
                <ul class="space-y-4">
                    <li class="p-4 bg-gray-50 rounded-lg shadow-sm">
                        <h4 class="font-semibold text-lg" data-lang-key="build_content2_step1_title">1. Power Distribution</h4>
                        <p class="text-gray-600" data-lang-key="build_content2_step1_desc">Install the 12V Mean Well PSU. Use a terminal block to distribute 12V power to the Jetson, motor drivers, and two DC-DC converters. One buck converter steps 12V down to 5V (for logic), and one boost converter steps 12V up to 24V (for the solenoid).</p>
                    </li>
                    <li class="p-4 bg-gray-50 rounded-lg shadow-sm">
                        <h4 class="font-semibold text-lg" data-lang-key="build_content2_step2_title">2. Motion Control Wiring</h4>
                        <p class="text-gray-600" data-lang-key="build_content2_step2_desc">Connect the Jetson's GPIO pins to the `PUL+` (Pulse) and `DIR+` (Direction) inputs on the DM542S motor drivers. Connect the driver `PUL-` and `DIR-` pins to the Jetson's GND. Connect the four motor wires (A+, A-, B+, B-) from each NEMA 23 to its corresponding driver.</p>
                    </li>
                    <li class="p-4 bg-gray-50 rounded-lg shadow-sm">
                        <h4 class="font-semibold text-lg" data-lang-key="build_content2_step3_title">3. Firing & Vision Connections</h4>
                        <p class="text-gray-600" data-lang-key="build_content2_step3_desc">Wire the 24V solenoid to a 1-channel relay. The relay's logic side (VCC, GND, IN) is controlled by a 5V signal from the Jetson. To avoid USB bandwidth limits, connect the three cameras to a powered USB-C hub.</p>
                    </li>
                </ul>
            </div>

            <div id="tab-content-ai" class="tab-content hidden">
                <h3 class="text-2xl font-semibold text-blue-700 mb-4" data-lang-key="build_content3_title">Phase 3: AI Model & Software</h3>
                <p class="mb-6 text-gray-700" data-lang-key="build_content3_desc">This phase involves creating the "brain" of the turret. A custom object detection model is trained to recognize targets and the control script integrates all hardware into one autonomous system.</p>
                <ul class="space-y-4">
                    <li class="p-4 bg-gray-50 rounded-lg shadow-sm">
                        <h4 class="font-semibold text-lg" data-lang-key="build_content3_step1_title">1. Build the Custom Dataset</h4>
                        <p class="text-gray-600" data-lang-key="build_content3_step1_desc">Gather thousands of images for three classes: `formosan_macaque`, `muntjac`, and `human`. The 'human' class must be extremely diverse (poses, clothing, lighting) to ensure safety.</p>
                    </li>
                    <li class="p-4 bg-gray-50 rounded-lg shadow-sm">
                        <h4 class="font-semibold text-lg" data-lang-key="build_content3_step2_title">2. Annotate and Train (YOLO)</h4>
                        <p class="text-gray-600" data-lang-key="build_content3_step2_desc">Use a tool like CVAT or Roboflow to draw bounding boxes around all objects in the dataset. Train a YOLO model (using the `ultralytics` package) on this custom dataset. This "transfer learning" process fine-tunes a pre-trained model for this specific task, resulting in a `best.pt` file.</p>
                    </li>
                    <li class="p-4 bg-gray-50 rounded-lg shadow-sm">
                        <h4 class="font-semibold text-lg" data-lang-key="build_content3_step3_title">3. Deploy with TensorRT & Write Control Script</h4>
                        <p class="text-gray-600" data-lang-key="build_content3_step3_desc">On the Jetson, convert the `best.pt` model to a `best.engine` file using `model.export(format='engine')`. This provides a massive speedup. The final Python script uses multi-threading to read all cameras, runs inference, and implements a state machine (SAFE, TRACKING, SEARCHING) to control the PID motor loops and firing relay.</p>
                    </li>
                </ul>
            </div>

            <div id="tab-content-calibration" class="tab-content hidden">
                <h3 class="text-2xl font-semibold text-blue-700 mb-4" data-lang-key="build_content4_title">Phase 4: Calibration & Testing</h3>
                <p class="mb-6 text-gray-700" data-lang-key="build_content4_desc">This final phase "glues" the vision system to the motion system, ensuring that what the camera sees is where the gun points. This is followed by performance tuning and critical safety checks.</p>
                <ul class="space-y-4">
                    <li class="p-4 bg-gray-50 rounded-lg shadow-sm">
                        <h4 class="font-semibold text-lg" data-lang-key="build_content4_step1_title">1. Intrinsic Camera Calibration</h4>
                        <p class="text-gray-600" data-lang-key="build_content4_step1_desc">For each of the three cameras, use OpenCV and a printed chessboard pattern to calculate the lens distortion. This step generates a camera matrix and distortion coefficients that are used to `cv2.undistort()` every frame, ensuring all lines are straight.</p>
                    </li>
                    <li class="p-4 bg-gray-50 rounded-lg shadow-sm">
                        <h4 class="font-semibold text-lg" data-lang-key="build_content4_step2_title">2. Turret-to-Camera Mapping (Homography)</h4>
                        <p class="text-gray-600" data-lang-key="build_content4_step2_desc">This is the most critical step. Mount a laser pointer on the gun. Write a script to move the turret to a grid of known angles. At each point, record the laser dot's `(pixel_x, pixel_y)` coordinate. This creates a dataset mapping angles to pixels, which is used to compute a transformation matrix. This matrix allows the code to instantly convert a target's pixel location into the motor angles needed to aim at it.</p>
                    </li>
                    <li class="p-4 bg-gray-50 rounded-lg shadow-sm">
                        <h4 class="font-semibold text-lg" data-lang-key="build_content4_step3_title">3. PID Tuning & Field Testing</h4>
                        <p class="text-gray-600" data-lang-key="build_content4_step3_desc">In a safe area, tune the `kP`, `kI`, and `kD` gains for the pan and tilt PID controllers. This ensures the tracking is fast, smooth, and does not overshoot the target. Start with P, then D, then I.</p>
                    </li>
                </ul>
            </div>
        </section>

        <section id="safety" class="content-section bg-red-100 border-t-4 border-red-500">
            <h2 class="text-3xl font-bold text-center text-red-800 mb-8" data-lang-key="safety_title">Safety & Ethical Protocols</h2>
            <p class="text-lg text-red-700 text-center max-w-3xl mx-auto mb-12" data-lang-key="safety_subtitle">Safety is the highest priority. This system is an autonomous tool, and its development and operation carry significant responsibility. These protocols are mandatory and non-negotiable.</p>
            <div class="max-w-3xl mx-auto bg-white rounded-lg shadow-xl p-8">
                <ul class="space-y-6">
                    <li class="flex items-start">
                        <span class="text-3xl mr-4 text-red-600" role="img" aria-label="stop button">üõë</span>
                        <div>
                            <h4 class="text-xl font-semibold text-red-800" data-lang-key="safety_item1_title">Physical E-Stop</h4>
                            <p class="text-gray-700" data-lang-key="safety_item1_desc">A large, red, physical "Emergency Stop" button must be wired to cut all power to the motors and firing solenoid, providing a foolproof hardware-level override.</p>
                        </div>
                    </li>
                    <li class="flex items-start">
                        <span class="text-3xl mr-4 text-red-600" role="img" aria-label="shield">üõ°Ô∏è</span>
                        <div>
                            <h4 class="text-xl font-semibold text-red-800" data-lang-key="safety_item2_title">Robust Human Detection</h4>
                            <p class="text-gray-700" data-lang-key="safety_item2_desc">The "Safe Mode" is the primary software defense. The confidence threshold for human detection must be set conservatively low (e.g., 0.3) to prioritize avoiding false negatives (failing to see a human) over false positives.</p>
                        </div>
                    </li>
                    <li class="flex items-start">
                        <span class="text-3xl mr-4 text-red-600" role="img"aria-label="map">üó∫Ô∏è</span>
                        <div>
                            <h4 class="text-xl font-semibold text-red-800" data-lang-key="safety_item3_title">Geofencing</h4>
                            <p class="text-gray-700" data-lang-key="safety_item3_desc">The turret's operational range must be programmatically limited to prevent it from aiming or firing outside the designated protected area.</p>
                        </div>
                    </li>
                    <li class="flex items-start">
                        <span class="text-3xl mr-4 text-red-600" role="img" aria-label="person watching">üëÄ</span>
                        <div>
                            <h4 class="text-xl font-semibold text-red-800" data-lang-key="safety_item4_title">Supervised Operation</h4>
                            <p class="text-gray-700" data-lang-key="safety_item4_desc">The system must never be left completely unattended. A human operator must always be present and able to intervene using the E-Stop.</p>
                        </div>
                    </li>
                </ul>
            </div>
        </section>
    </main>

    <footer class="bg-gray-800 text-gray-300 mt-16 py-8">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <p data-lang-key="footer_copyright">&copy; 2025 AI Turret Project Explorer.</p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {

            let currentLanguage = 'en'; // Set default language here

            // --- TRANSLATION SCRIPT ---
            const translations = {
                'en': {
                    'page_title': 'AI Farm Land Sentry',
                    'lang_btn_text': 'EN',
                    'lang_btn_title': 'Language',
                    'nav_title': 'AI Farm Land Sentry',
                    'nav_home': 'Home',
                    'nav_3d': '3D Turret View',
                    'nav_overview': 'System Overview',
                    'nav_live_feed': 'Live Feed',
                    'nav_components': 'Components',
                    'nav_build': 'Build Guides',
                    'nav_safety': 'Safety',
                    'nav_lang_title': 'Language', // Added for mobile
                    'home_title': 'AI Farm Land Sentry',
                    'home_subtitle': 'An interactive guide to the construction and programming of an intelligent, non-lethal wildlife deterrent. This system is designed to identify and discourage specific animals from protected areas while actively detecting and avoiding human presence.',
                    'home_explore_btn': 'Explore the System',
                    'home_target1_title': 'Target: Macaque',
                    'home_target1_desc': "Formosan Macaque (*Macaca cyclopis*)",
                    'home_target2_title': 'Target: Muntjac',
                    'home_target2_desc': "Formosan Muntjac (*Muntiacus reevesi micrurus*)",
                    'home_target3_title': 'Target: Black Bear',
                    'home_target3_desc': 'Formosan Black Bear (*Ursus thibetanus formosanus*)',
                    'home_target4_title': 'Target: Wild Boar',
                    'home_target4_desc': 'Formosan Wild Boar (*Sus scrofa taivanus*)',
                    'home_avoid_title': 'Avoid: Human',
                    'home_avoid_desc': 'System enters safe mode on human detection.',
                    '3d_title': 'Interactive 3D AI Farm Land Sentry View',
                    '3d_subtitle': 'Explore the AI Farm Land Sentry from every angle! Use your mouse/finger to rotate, pan, and zoom the model. This interactive view allows you to inspect the mechanical and electronic components in detail.',
                    '3d_note1': '<strong>Note:</strong> This is an interactive 3D model viewer. It is currently displaying the "AI Farm Land Sentry" model.',
                    'overview_title': 'System Architecture',
                    'overview_subtitle': 'The turret operates on a classic "Perception-Decision-Actuation" loop. This model explains how the components work together in real-time. Click a cloud to learn more about its function and key components.',
                    'overview_btn1_title': '1. Perception',
                    'overview_btn1_desc': 'Sensing the environment.',
                    'overview_btn2_title': '2. Decision',
                    'overview_btn2_desc': 'Analyzing and planning.',
                    'overview_btn3_title': '3. Actuation',
                    'overview_btn3_desc': 'Taking physical action.',
                    'overview_content1_title': 'Perception: The 360¬∞ Tri-Camera System',
                    'overview_content1_desc': 'The system perceives its environment using a tri-camera array (3x Logitech C615 webcams), providing a stitched 360-degree panoramic view. The real-time feeds are processed by the AI, with each camera covering a 120-degree sector.',
                    'overview_content2_title': 'Decision: The AI Brain (Jetson & YOLO)',
                    'overview_content2_desc': 'The heart of the decision-making process is the NVIDIA Jetson Orin Nano. It runs a custom-trained YOLO model, processing all camera feeds in real-time. This model detects and classifies objects (macaque, muntjac, human). The control software applies a simple logic: if a human is seen, enter "Safe Mode." If a target animal is seen (and no human), calculate its position and initiate tracking.',
                    'overview_content3_title': 'Actuation: The Mechanical Response',
                    'overview_content3_desc': "Based on the AI's decision, the Jetson commands the physical hardware. It sends signals to two NEMA 23 stepper motors via DM542S drivers, which move the high-torque herringbone gear pan-tilt mechanism to aim the paintball gun. To fire, it sends a signal to a relay, which activates a 24V solenoid to pull the trigger. This entire loop repeats multiple times per second.",
                    'live_feed_title': 'Live 360¬∞ Visual Feed',
                    'live_feed_subtitle': 'This interface shows the real-time stitched video from the 3-camera array. Each feed includes compass and GPS data, allowing the AI to map threats in physical space.',
                    'components_title': 'Interactive Bill of Materials',
                    'components_subtitle': 'This is the complete list of components required for the project. Use the filters to explore parts by category or use the search bar to find a specific item. A breakdown of component categories is shown in the chart.',
                    'components_chart_title': 'Component Categories',
                    'components_software_title': 'Key Software Stack',
                    'components_sw1_title': 'Operating System',
                    'components_sw1_desc': 'NVIDIA JetPack SDK (on Jetson)',
                    'components_sw1_notes': 'Includes Ubuntu, CUDA, cuDNN, and TensorRT.',
                    'components_sw2_title': 'Core Language',
                    'components_sw2_desc': 'Python 3.x',
                    'components_sw2_notes': 'For the main control script, inference, and hardware I/O.',
                    'components_sw3_title': 'AI / Object Detection',
                    'components_sw3_desc': 'Ultralytics YOLO (v11 cited, v8+ common)',
                    'components_sw3_notes': 'Used for training and running the detection model.',
                    'components_sw4_title': 'Key Libraries',
                    'components_sw4_desc': 'OpenCV, TensorRT, RPi.GPIO (or similar)',
                    'components_sw4_notes': 'For camera vision, model acceleration, and motor control.',
                    'components_search_placeholder': "Search for a component (e.g., 'Jetson', 'NEMA 23')...",
                    'build_title': 'Interactive Build Guides',
                    'build_subtitle': 'Explore the four core phases of building this AI Turret. Click on any cloud below to reveal detailed steps, challenges, and insights for that stage of development.',
                    'build_btn1_title': 'Mechanical Assembly',
                    'build_btn1_desc': 'Physical frame & motion system',
                    'build_btn2_title': 'Electronics & Wiring',
                    'build_btn2_desc': 'Power, logic & control components',
                    'build_btn3_title': 'AI Model & Software',
                    'build_btn3_desc': 'Training vision & control script',
                    'build_btn4_title': 'Calibration & Testing',
                    'build_btn4_desc': 'Aligning vision & hardware',
                    'build_content1_title': 'Phase 1: Mechanical Assembly',
                    'build_content1_desc': 'This phase involves building the physical structure and motion system. Precision and rigidity are the primary goals. The core of this phase is the high-torque herringbone gear drive, which provides backlash-free, precise aiming.',
                    'build_content1_step1_title': '1. Construct the Main Frame',
                    'build_content1_step1_desc': 'Assemble the 2020 aluminum extrusion base and gantry. Use corner brackets and T-nuts to create a rigid skeleton, ensuring all corners are perfectly square.',
                    'build_content1_step2_title': '2. Fabricate & Assemble Pan-Tilt Drive',
                    'build_content1_step2_desc': '3D print the large herringbone gears (pan and tilt) and motor pinions from PETG or ABS. Mount the pan motor inside the frame, meshing with the main ring gear which sits on a thrust bearing. Assemble the tilt gantry with its motor and gear, supported by deep groove ball bearings.',
                    'build_content1_step3_title': '3. Mount Payload & Vision System',
                    'build_content1_step3_desc': 'Secure the paintball gun in its 3D printed cradle. Install the 24V solenoid using a custom bracket, aligning it perfectly with the trigger. Mount the three webcams on the stationary base frame to create the overlapping 360¬∞ field of view.',
                    'build_content2_title': 'Phase 2: Electronics & Wiring',
                    'build_content2_desc': "This phase connects all components, distributing power and control signals. A clean, methodical wiring plan with proper grounding is essential to prevent electrical noise from interfering with the Jetson's logic signals.",
                    'build_content2_step1_title': '1. Power Distribution',
                    'build_content2_step1_desc': 'Install the 12V Mean Well PSU. Use a terminal block to distribute 12V power to the Jetson, motor drivers, and two DC-DC converters. One buck converter steps 12V down to 5V (for logic), and one boost converter steps 12V up to 24V (for the solenoid).',
                    'build_content2_step2_title': '2. Motion Control Wiring',
                    'build_content2_step2_desc': "Connect the Jetson's GPIO pins to the `PUL+` (Pulse) and `DIR+` (Direction) inputs on the DM542S motor drivers. Connect the driver `PUL-` and `DIR-` pins to the Jetson's GND. Connect the four motor wires (A+, A-, B+, B-) from each NEMA 23 to its corresponding driver.",
                    'build_content2_step3_title': '3. Firing & Vision Connections',
                    'build_content2_step3_desc': "Wire the 24V solenoid to a 1-channel relay. The relay's logic side (VCC, GND, IN) is controlled by a 5V signal from the Jetson. To avoid USB bandwidth limits, connect the three cameras to a powered USB-C hub.",
                    'build_content3_title': 'Phase 3: AI Model & Software',
                    'build_content3_desc': 'This phase involves creating the "brain" of the turret. A custom object detection model is trained to recognize targets and the control script integrates all hardware into one autonomous system.',
                    'build_content3_step1_title': '1. Build the Custom Dataset',
                    'build_content3_step1_desc': "Gather thousands of images for three classes: `formosan_macaque`, `muntjac`, and `human`. The 'human' class must be extremely diverse (poses, clothing, lighting) to ensure safety.",
                    'build_content3_step2_title': '2. Annotate and Train (YOLO)',
                    'build_content3_step2_desc': 'Use a tool like CVAT or Roboflow to draw bounding boxes around all objects in the dataset. Train a YOLO model (using the `ultralytics` package) on this custom dataset. This "transfer learning" process fine-tunes a pre-trained model for this specific task, resulting in a `best.pt` file.',
                    'build_content3_step3_title': '3. Deploy with TensorRT & Write Control Script',
                    'build_content3_step3_desc': "On the Jetson, convert the `best.pt` model to a `best.engine` file using `model.export(format='engine')`. This provides a massive speedup. The final Python script uses multi-threading to read all cameras, runs inference, and implements a state machine (SAFE, TRACKING, SEARCHING) to control the PID motor loops and firing relay.",
                    'build_content4_title': 'Phase 4: Calibration & Testing',
                    'build_content4_desc': 'This final phase "glues" the vision system to the motion system, ensuring that what the camera sees is where the gun points. This is followed by performance tuning and critical safety checks.',
                    'build_content4_step1_title': '1. Intrinsic Camera Calibration',
                    'build_content4_step1_desc': 'For each of the three cameras, use OpenCV and a printed chessboard pattern to calculate the lens distortion. This step generates a camera matrix and distortion coefficients that are used to `cv2.undistort()` every frame, ensuring all lines are straight.',
                    'build_content4_step2_title': '2. Turret-to-Camera Mapping (Homography)',
                    'build_content4_step2_desc': "This is the most critical step. Mount a laser pointer on the gun. Write a script to move the turret to a grid of known angles. At each point, record the laser dot's `(pixel_x, pixel_y)` coordinate. This creates a dataset mapping angles to pixels, which is used to compute a transformation matrix. This matrix allows the code to instantly convert a target's pixel location into the motor angles needed to aim at it.",
                    'build_content4_step3_title': '3. PID Tuning & Field Testing',
                    'build_content4_step3_desc': 'In a safe area, tune the `kP`, `kI`, and `kD` gains for the pan and tilt PID controllers. This ensures the tracking is fast, smooth, and does not overshoot the target. Start with P, then D, then I.',
                    'safety_title': 'Safety & Ethical Protocols',
                    'safety_subtitle': 'Safety is the highest priority. This system is an autonomous tool, and its development and operation carry significant responsibility. These protocols are mandatory and non-negotiable.',
                    'safety_item1_title': 'Physical E-Stop',
                    'safety_item1_desc': 'A large, red, physical "Emergency Stop" button must be wired to cut all power to the motors and firing solenoid, providing a foolproof hardware-level override.',
                    'safety_item2_title': 'Robust Human Detection',
                    'safety_item2_desc': 'The "Safe Mode" is the primary software defense. The confidence threshold for human detection must be set conservatively low (e.g., 0.3) to prioritize avoiding false negatives (failing to see a human) over false positives.',
                    'safety_item3_title': 'Geofencing',
                    'safety_item3_desc': "The turret's operational range must be programmatically limited to prevent it from aiming or firing outside the designated protected area.",
                    'safety_item4_title': 'Supervised Operation',
                    'safety_item4_desc': 'The system must never be left completely unattended. A human operator must always be present and able to intervene using the E-Stop.',
                    'footer_copyright': '¬© 2025 AI Farm Land Sentry. All rights reserved.'
                }
                // Removed 'zh-tw' translations
            };

            
            const mobileMenuBtn = document.getElementById('mobile-menu-btn');
            const mobileMenu = document.getElementById('mobile-menu');

            function setLanguage(lang) {
                // Only use 'en' translations
                lang = 'en'; 
                currentLanguage = lang; // Update current language variable
                document.documentElement.lang = lang;
                
                // Check if translations for 'en' exist
                if (!translations[lang]) {
                    console.error("English translations not found!");
                    return;
                }

                document.getElementById('page-title').textContent = translations[lang]['page_title'];

                const elements = document.querySelectorAll('[data-lang-key]');
                elements.forEach(el => {
                    const key = el.dataset.langKey;
                    if (translations[lang][key]) {
                        el.innerHTML = translations[lang][key];
                    }
                });

                // Update search placeholder
                const searchInput = document.getElementById('searchInput');
                if (searchInput) {
                    searchInput.placeholder = translations[lang]['components_search_placeholder'];
                }

                // Re-render component list with new language
                renderComponents();

                // Close dropdowns
                if (mobileMenu) mobileMenu.classList.add('hidden');
                // Update mobile menu icons
                if (mobileMenuBtn) {
                    const hamburgerIcon = mobileMenuBtn.querySelector('svg:nth-of-type(1)');
                    const closeIcon = mobileMenuBtn.querySelector('svg:nth-of-type(2)');
                    if (hamburgerIcon) {
                        hamburgerIcon.classList.remove('hidden');
                        hamburgerIcon.classList.add('block');
                    }
                    if (closeIcon) {
                        closeIcon.classList.add('hidden');
                        closeIcon.classList.remove('block');
                    }
                }
            }


            // Mobile Menu Toggle
            if (mobileMenuBtn) {
                mobileMenuBtn.addEventListener('click', () => {
                    const isOpen = mobileMenu.classList.toggle('hidden'); // true if hidden, false if open
                    const hamburgerIcon = mobileMenuBtn.querySelector('svg:nth-of-type(1)');
                    const closeIcon = mobileMenuBtn.querySelector('svg:nth-of-type(2)');

                    if (hamburgerIcon) {
                        hamburgerIcon.classList.toggle('hidden', !isOpen); // Hide hamburger if open
                        hamburgerIcon.classList.toggle('block', isOpen);  // Show hamburger if hidden
                    }
                    if (closeIcon) {
                        closeIcon.classList.toggle('hidden', isOpen);  // Show close if open
                        closeIcon.classList.toggle('block', !isOpen); // Hide close if hidden
                    }
                });
            }

            // Close mobile menu when a link is clicked
            document.querySelectorAll('#mobile-menu a').forEach(link => {
                if(link.href.includes('#')) {
                    link.addEventListener('click', () => {
                        mobileMenu.classList.add('hidden');
                        const hamburgerIcon = mobileMenuBtn.querySelector('svg:nth-of-type(1)');
                        const closeIcon = mobileMenuBtn.querySelector('svg:nth-of-type(2)');
                        if (hamburgerIcon) {
                            hamburgerIcon.classList.remove('hidden');
                            hamburgerIcon.classList.add('block');
                        }
                        if (closeIcon) {
                            closeIcon.classList.add('hidden');
                            closeIcon.classList.remove('block');
                        }
                    });
                }
            });

            // --- COMPONENT LIST SCRIPT ---
            const allComponents = [
                // Simplified component data structure (English only)
                { category: 'Computing', name: 'Jetson Orin Nano Dev Kit', spec: '-', qty: 1, role: 'Central processing unit for AI inference and system control.' },
                { category: 'Structure', name: '2020 Aluminum Extrusion', spec: '45 cm', qty: 12, role: 'Forms the primary structural frame.' },
                { category: 'Structure', name: '2020 Aluminum Extrusion', spec: '100 cm', qty: 12, role: 'Forms the primary structural frame.' },
                { category: 'Structure', name: '2020 Corner Brackets', spec: '90-degree', qty: 40, role: 'Connects extrusions to form rigid frame corners.' },
                { category: 'Structure', name: 'M5 T-Nuts', spec: 'For 2020', qty: 100, role: 'Provides threaded mounting points in extrusion slots.' },
                { category: 'Structure', name: 'M5 Button Head Cap Screws', spec: '8 mm', qty: 100, role: 'Fastens components to T-nuts.' },
                { category: 'Motion', name: 'NEMA 23 Stepper Motor', spec: 'High Torque (>2 N¬∑m)', qty: 2, role: 'Provides rotational force for pan and tilt axes.' },
                { category: 'Motion', name: 'Microstep Driver', spec: 'DM542S', qty: 2, role: 'Controls the current and stepping of the NEMA 23 motors.' },
                { category: 'Motion', name: 'NEMA 23 Mounting Plate', spec: '60x90 mm', qty: 2, role: 'Securely mounts the stepper motors to the frame.' },
                { category: 'Motion', name: 'Large Herringbone Ring Gear', spec: '3D Printed, ~200mm OD', qty: 1, role: 'Pan axis main gear for high torque and precision.' },
                { category: 'Motion', name: 'Large Herringbone Tilt Gear', spec: '3D Printed, ~120mm OD', qty: 1, role: 'Tilt axis main gear.' },
                { category: 'Motion', name: 'Motor Pinion Gear', spec: '3D Printed', qty: 2, role: 'Small gear attached to the motor shaft.' },
                { category: 'Motion', name: 'Thrust Bearing', spec: 'e.g., 51110 (50mm ID)', qty: 1, role: 'Supports the axial load of the rotating turret.' },
                { category: 'Motion', name: 'Deep Groove Ball Bearings', spec: 'e.g., 6806-2RS (30mm ID)', qty: 2, role: 'Supports the tilt axis shaft for smooth rotation.' },
                { category: 'Payload', name: 'Paintball Gun', spec: 'Valken Razorback', qty: 1, role: 'The projectile delivery system.' },
                { category: 'Payload', name: 'Push-Pull Solenoid', spec: 'DC 24V, 35mm stroke', qty: 1, role: 'Actuates the trigger mechanism.' },
                { category: 'Payload', name: 'Solenoid Mounting Bracket', spec: 'Custom 3D Printed', qty: 1, role: 'Holds the solenoid in a precise position.' },
                { category: 'Vision', name: 'Webcam', spec: 'Logitech C615', qty: 3, role: 'Provides 360-degree video input.' },
                { category: 'Vision', name: 'USB-C to USB-A Hub', spec: '4-port, powered', qty: 1, role: 'Bypasses bandwidth limitations on the main USB hub.' },
                { category: 'Vision', name: 'Camera Mounts', spec: 'Custom 3D Printed', qty: 3, role: 'Positions cameras on the frame.' },
                { category: 'Power', name: 'Switching Power Supply', spec: 'Mean Well LRS-150-12', qty: 1, role: 'Provides main 12V DC power from AC.' },
                { category: 'Power', name: 'DC-DC Buck Converter', spec: 'LM2596', qty: 1, role: 'Steps down 12V to 5V for logic.' },
                { category: 'Power', name: 'DC-DC Boost Converter', spec: 'XL6009', qty: 1, role: 'Steps up 12V to 24V for the solenoid.' },
                { category: 'Power', name: 'AC Power Cord', spec: '3-prong, grounded', qty: 1, role: 'Connects the PSU to mains power.' },
                { category: 'Control', name: 'ESP32 Dev Board', spec: 'Optional', qty: 1, role: 'Optional secondary controller or GPIO expander.' },
                { category: 'Control', name: 'Relay Module', spec: '1-channel, 5V logic', qty: 1, role: 'Switches the 24V power to the solenoid.' },
                { category: 'Control', name: 'Terminal Block Connectors', spec: 'Screw terminals', qty: 1, role: 'Facilitates clean power and signal distribution.' },
                { category: 'Control', name: 'Jumper Wires & Hookup Wire', spec: '18-22 AWG', qty: 1, role: 'For all electrical connections.' }
            ];

            let activeCategory = 'All';
            let searchTerm = '';

            const componentGrid = document.getElementById('component-grid');
            const categoryFilters = document.getElementById('category-filters');
            const searchInput = document.getElementById('searchInput');

            function renderComponents() {
                if (!componentGrid) return; // Safety check
                
                const filtered = allComponents.filter(item => {
                    const inCategory = activeCategory === 'All' || item.category === activeCategory;
                    const inSearch = searchTerm === '' || 
                                     item.name.toLowerCase().includes(searchTerm) || 
                                     item.role.toLowerCase().includes(searchTerm);
                    return inCategory && inSearch;
                });


                if (filtered.length === 0) {
                    componentGrid.innerHTML = `<p class="text-gray-600 col-span-1 md:col-span-2 text-center">No components match your criteria.</p>`;
                    return;
                }

                componentGrid.innerHTML = filtered.map(item => `
                    <div class="component-card">
                        <div class="p-5">
                            <div class="flex justify-between items-start">
                                <h4 class="text-lg font-semibold text-blue-800">${item.name}</h4>
                                <span class="text-xs font-bold text-gray-500 bg-gray-100 px-2 py-1 rounded-full">${item.category}</span>
                            </div>
                            <p class="text-sm text-gray-500 mb-2">Spec: ${item.spec} (Qty: ${item.qty})</p>
                            <p class="text-sm text-gray-700">${item.role}</p>
                        </div>
                    </div>
                `).join('');
            }

            function initCategories() {
                if (!categoryFilters) return; // Safety check
                const categories = ['All', ...new Set(allComponents.map(item => item.category))];
                categoryFilters.innerHTML = categories.map(category => `
                    <button class="category-button ${category === 'All' ? 'active' : ''}" data-category="${category}">
                        ${category}
                    </button>
                `).join('');

                categoryFilters.addEventListener('click', (e) => {
                    if (e.target.tagName === 'BUTTON') {
                        activeCategory = e.target.dataset.category;
                        document.querySelectorAll('#category-filters .category-button').forEach(btn => {
                            btn.classList.remove('active');
                        });
                        e.target.classList.add('active');
                        renderComponents();
                    }
                });
            }

            if (searchInput) {
                searchInput.addEventListener('keyup', (e) => {
                    searchTerm = e.target.value.toLowerCase();
                    renderComponents();
                });
            }

            initCategories(); 
            // --- END COMPONENT LIST SCRIPT ---


            // --- UI INTERACTION SCRIPTS ---
            const overviewButtons = {
                perception: document.getElementById('btn-perception'),
                decision: document.getElementById('btn-decision'),
                actuation: document.getElementById('btn-actuation')
            };
            const overviewContents = {
                perception: document.getElementById('content-perception'),
                decision: document.getElementById('content-decision'),
                actuation: document.getElementById('content-actuation')
            };
            const overviewCloudWrappers = document.querySelectorAll('.overview-cloud-wrapper');


            function handleOverviewClick(event) {
                const wrapper = event.currentTarget;
                const section = wrapper.dataset.overview;

                const clickedButton = overviewButtons[section];
                const clickedContent = overviewContents[section];

                if (!clickedButton || !clickedContent) return;

                const isAlreadyActive = clickedButton.classList.contains('active');

                // Hide all content and deactivate all buttons/wrappers
                Object.values(overviewContents).forEach(el => el.classList.add('hidden'));
                Object.values(overviewButtons).forEach(el => el.classList.remove('active'));
                overviewCloudWrappers.forEach(el => {
                    el.classList.remove('active');
                    el.style.animationPlayState = 'running'; // Resume floating
                });

                if (!isAlreadyActive) {
                    clickedButton.classList.add('active');
                    clickedContent.classList.remove('hidden');
                    wrapper.classList.add('active'); // Add active to wrapper
                    wrapper.style.animationPlayState = 'paused'; // Pause floating
                    wrapper.style.transform = 'translateY(0px) scale(1.08)'; // Keep it scaled
                }
            }

            overviewCloudWrappers.forEach(wrapper => {
                wrapper.addEventListener('click', handleOverviewClick);
            });

            // Adjusted tab button logic for the build guide cloud buttons
            const tabButtons = {
                mechanical: document.getElementById('tab-btn-mechanical'),
                electronics: document.getElementById('tab-btn-electronics'),
                ai: document.getElementById('tab-btn-ai'),
                calibration: document.getElementById('tab-btn-calibration')
            };
            const tabContents = {
                mechanical: document.getElementById('tab-content-mechanical'),
                electronics: document.getElementById('tab-content-electronics'),
                ai: document.getElementById('tab-content-ai'),
                calibration: document.getElementById('tab-content-calibration')
            };

            const buildCloudWrappers = document.querySelectorAll('.cloud-button-wrapper[data-tab]');

            function handleBuildCloudClick(event) {
                const wrapper = event.currentTarget; // The div with class .cloud-button-wrapper
                const tabName = wrapper.dataset.tab; // Get the tab name from the data-tab attribute

                const clickedButton = tabButtons[tabName];
                const clickedContent = tabContents[tabName];

                if (!clickedButton || !clickedContent) return;

                const isAlreadyActive = clickedButton.classList.contains('active');

                // Hide all content and deactivate all buttons/wrappers
                Object.values(tabContents).forEach(el => el.classList.add('hidden'));
                Object.values(tabButtons).forEach(el => el.classList.remove('active'));
                buildCloudWrappers.forEach(el => {
                    el.querySelector('.cloud-button')?.classList.remove('active'); // Deactivate inner button style
                    el.style.animationPlayState = 'running'; // Resume floating for all
                });


                if (!isAlreadyActive) {
                    clickedButton.classList.add('active'); // Activate inner button style
                    clickedContent.classList.remove('hidden');
                    wrapper.style.animationPlayState = 'paused'; // Pause floating for active wrapper
                    wrapper.style.transform = 'translateY(0px) scale(1.08)'; // Keep it slightly scaled up and no float
                }
            }

            buildCloudWrappers.forEach(wrapper => {
                wrapper.addEventListener('click', handleBuildCloudClick);
            });


            // Smooth scroll for nav links
            document.querySelectorAll('a.nav-link[href^="#"], a.mobile-nav-link[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    document.querySelectorAll('a.nav-link, a.mobile-nav-link').forEach(link => link.classList.remove('active'));
                    this.classList.add('active');

                    const targetId = this.getAttribute('href');
                    const targetElement = document.querySelector(targetId);
                    if (targetElement) {
                        targetElement.scrollIntoView({
                            behavior: 'smooth'
                        });
                    }
                });
            });

            // BOM Chart
            const bomCtx = document.getElementById('bomChart')?.getContext('2d');
            if (bomCtx) {
                const categoryCounts = allComponents.reduce((acc, item) => {
                    acc[item.category] = (acc[item.category] || 0) + 1;
                    return acc;
                }, {});

                new Chart(bomCtx, {
                    type: 'doughnut',
                    data: {
                        labels: Object.keys(categoryCounts),
                        datasets: [{
                            label: 'Component Categories',
                            data: Object.values(categoryCounts),
                            backgroundColor: [
                                '#0077b6', // Computing
                                '#00b4d8', // Structure
                                '#90e0ef', // Motion
                                '#343a40', // Payload
                                '#6c757d', // Vision
                                '#adb5bd', // Power
                                '#ced4da', // Control
                                '#ffb703'  // Fallback color
                            ],
                            borderColor: '#f8f7f4',
                            borderWidth: 3
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'right',
                                labels: {
                                    color: '#343a40',
                                    font: {
                                        family: 'Inter'
                                    }
                                }
                            }
                        }
                    }
                });
            }
             // --- END UI INTERACTION SCRIPTS ---

             // Set initial language AFTER all functions and variables are defined
            setLanguage(currentLanguage); // This will default to 'en'

        });
    </script>
</body>
</html>
